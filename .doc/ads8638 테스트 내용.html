<!DOCTYPE html>
<!-- saved from url=(0057)file:///C:/Users/SIDO/AppData/Local/Temp/tmp32ea7m3w.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                
                <title>All Slides</title>
                <style>
        pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #49483e }
.highlight { background: #272822; color: #F8F8F2 }
.highlight .c { color: #959077 } /* Comment */
.highlight .err { color: #ED007E; background-color: #1E0010 } /* Error */
.highlight .esc { color: #F8F8F2 } /* Escape */
.highlight .g { color: #F8F8F2 } /* Generic */
.highlight .k { color: #66D9EF } /* Keyword */
.highlight .l { color: #AE81FF } /* Literal */
.highlight .n { color: #F8F8F2 } /* Name */
.highlight .o { color: #FF4689 } /* Operator */
.highlight .x { color: #F8F8F2 } /* Other */
.highlight .p { color: #F8F8F2 } /* Punctuation */
.highlight .ch { color: #959077 } /* Comment.Hashbang */
.highlight .cm { color: #959077 } /* Comment.Multiline */
.highlight .cp { color: #959077 } /* Comment.Preproc */
.highlight .cpf { color: #959077 } /* Comment.PreprocFile */
.highlight .c1 { color: #959077 } /* Comment.Single */
.highlight .cs { color: #959077 } /* Comment.Special */
.highlight .gd { color: #FF4689 } /* Generic.Deleted */
.highlight .ge { color: #F8F8F2; font-style: italic } /* Generic.Emph */
.highlight .ges { color: #F8F8F2; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #F8F8F2 } /* Generic.Error */
.highlight .gh { color: #F8F8F2 } /* Generic.Heading */
.highlight .gi { color: #A6E22E } /* Generic.Inserted */
.highlight .go { color: #66D9EF } /* Generic.Output */
.highlight .gp { color: #FF4689; font-weight: bold } /* Generic.Prompt */
.highlight .gs { color: #F8F8F2; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #959077 } /* Generic.Subheading */
.highlight .gt { color: #F8F8F2 } /* Generic.Traceback */
.highlight .kc { color: #66D9EF } /* Keyword.Constant */
.highlight .kd { color: #66D9EF } /* Keyword.Declaration */
.highlight .kn { color: #FF4689 } /* Keyword.Namespace */
.highlight .kp { color: #66D9EF } /* Keyword.Pseudo */
.highlight .kr { color: #66D9EF } /* Keyword.Reserved */
.highlight .kt { color: #66D9EF } /* Keyword.Type */
.highlight .ld { color: #E6DB74 } /* Literal.Date */
.highlight .m { color: #AE81FF } /* Literal.Number */
.highlight .s { color: #E6DB74 } /* Literal.String */
.highlight .na { color: #A6E22E } /* Name.Attribute */
.highlight .nb { color: #F8F8F2 } /* Name.Builtin */
.highlight .nc { color: #A6E22E } /* Name.Class */
.highlight .no { color: #66D9EF } /* Name.Constant */
.highlight .nd { color: #A6E22E } /* Name.Decorator */
.highlight .ni { color: #F8F8F2 } /* Name.Entity */
.highlight .ne { color: #A6E22E } /* Name.Exception */
.highlight .nf { color: #A6E22E } /* Name.Function */
.highlight .nl { color: #F8F8F2 } /* Name.Label */
.highlight .nn { color: #F8F8F2 } /* Name.Namespace */
.highlight .nx { color: #A6E22E } /* Name.Other */
.highlight .py { color: #F8F8F2 } /* Name.Property */
.highlight .nt { color: #FF4689 } /* Name.Tag */
.highlight .nv { color: #F8F8F2 } /* Name.Variable */
.highlight .ow { color: #FF4689 } /* Operator.Word */
.highlight .pm { color: #F8F8F2 } /* Punctuation.Marker */
.highlight .w { color: #F8F8F2 } /* Text.Whitespace */
.highlight .mb { color: #AE81FF } /* Literal.Number.Bin */
.highlight .mf { color: #AE81FF } /* Literal.Number.Float */
.highlight .mh { color: #AE81FF } /* Literal.Number.Hex */
.highlight .mi { color: #AE81FF } /* Literal.Number.Integer */
.highlight .mo { color: #AE81FF } /* Literal.Number.Oct */
.highlight .sa { color: #E6DB74 } /* Literal.String.Affix */
.highlight .sb { color: #E6DB74 } /* Literal.String.Backtick */
.highlight .sc { color: #E6DB74 } /* Literal.String.Char */
.highlight .dl { color: #E6DB74 } /* Literal.String.Delimiter */
.highlight .sd { color: #E6DB74 } /* Literal.String.Doc */
.highlight .s2 { color: #E6DB74 } /* Literal.String.Double */
.highlight .se { color: #AE81FF } /* Literal.String.Escape */
.highlight .sh { color: #E6DB74 } /* Literal.String.Heredoc */
.highlight .si { color: #E6DB74 } /* Literal.String.Interpol */
.highlight .sx { color: #E6DB74 } /* Literal.String.Other */
.highlight .sr { color: #E6DB74 } /* Literal.String.Regex */
.highlight .s1 { color: #E6DB74 } /* Literal.String.Single */
.highlight .ss { color: #E6DB74 } /* Literal.String.Symbol */
.highlight .bp { color: #F8F8F2 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #A6E22E } /* Name.Function.Magic */
.highlight .vc { color: #F8F8F2 } /* Name.Variable.Class */
.highlight .vg { color: #F8F8F2 } /* Name.Variable.Global */
.highlight .vi { color: #F8F8F2 } /* Name.Variable.Instance */
.highlight .vm { color: #F8F8F2 } /* Name.Variable.Magic */
.highlight .il { color: #AE81FF } /* Literal.Number.Integer.Long */

        body {
            font-family: 'NanumSquare', 'NanumBarunGothic', 'Malgun Gothic Bold', 'AppleSDGothicNeo-Bold', 'Segoe UI Semibold', Arial Black, sans-serif;
            margin: 0;
            padding: 0;
            background: white;
            color: #222;
            font-weight: 700;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .slide-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 40px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        h1 {
            font-size: 2.5em;
            color: #007acc;
            border-bottom: 3px solid #007acc;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-weight: 900;
        }

        h2 {
            font-size: 2.0em;
            color: #005a9e;
            margin-top: 40px;
            margin-bottom: 20px;
            font-weight: 800;
        }

        h3 {
            font-size: 1.5em;
            color: #333;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 15px;
            font-weight: 600;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
        }

        pre {
            background: #272822;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        ul, ol {
            font-size: 1.2em;
            line-height: 1.8;
            margin-left: 30px;
            font-weight: 600;
        }

        li {
            margin-bottom: 10px;
            font-size: 1.0em;
            font-weight: 600;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 1.1em;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #007acc;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid #007acc;
            margin: 20px 0;
            padding-left: 20px;
            color: #555;
            font-style: italic;
            font-size: 1.0em;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
            @media print {
                .slide-content {
                    page-break-after: always;
                }
                .slide-content:last-child {
                    page-break-after: auto;
                }
            }
            </style>
            </head>
            <body>
                
                <div class="slide-content">
                    <h1>ADS8638 ADC 동작 불량 분석 보고서</h1>
<p><strong>작성일</strong>: 2025년 1월 21일<br>
<strong>프로젝트</strong>: STM32H743 BLDC 모터 제어 보드<br>
<strong>대상</strong>: 생기연</p>
                </div>
                
                <div class="slide-content">
                    <h2>1. 요약</h2>
<p>ADS8638 8채널 12비트 ADC 칩이 정상적으로 동작하지 않는 문제가 발견되었습니다. 총 3개의 칩을 테스트한 결과, 모두 동일한 증상(레지스터 쓰기 실패, 내부 레퍼런스 미동작)을 보였습니다. 분석 결과, <strong>과도한 납땜 온도(300°C)</strong>가 주요 원인으로 판단되며, 일부 칩은 공급 단계부터 이미 손상되었을 가능성이 있습니다.</p>
<h3>주요 발견 사항</h3>
<ul>
<li>✅ SPI 통신 부분 동작 (READ 가능)</li>
<li>❌ 레지스터 쓰기 완전 실패 (모든 WRITE 명령 무시)</li>
<li>❌ 내부 2.5V 레퍼런스 미동작 (REF 핀 = 0V)</li>
<li>❌ 모든 ADC 값 4095(0xFFF) 고정</li>
<li>⚠️ 납땜 온도 300°C 사용 (권장 260-280°C 대비 과도)</li>
</ul>
                </div>
                
                <div class="slide-content">
                    <h2>2. 문제 증상</h2>
<h3>2.1 초기 증상</h3>
<div class="highlight"><pre><span></span><code>- 모든 ADC 채널 값: 4095 (0xFFF, 12비트 최댓값)
- REF 핀 전압: 0V (예상: 2.5V)
- 레지스터 읽기: 모두 0x00 반환 (power-on default: 0x08, 0x11)
- MISO: 항상 0x0F 0x?? 패턴
</code></pre></div>

<h3>2.2 하드웨어 확인 결과</h3>
<table>
<thead>
<tr>
<th>항목</th>
<th>예상값</th>
<th>측정값</th>
<th>상태</th>
</tr>
</thead>
<tbody>
<tr>
<td>AVDD (Pin 1)</td>
<td>3.3V</td>
<td>3.3V</td>
<td>✅ 정상</td>
</tr>
<tr>
<td>DVDD (Pin 21)</td>
<td>3.3V</td>
<td>3.3V</td>
<td>✅ 정상</td>
</tr>
<tr>
<td>HVDD (Pin 14)</td>
<td>12V</td>
<td>12V</td>
<td>✅ 정상</td>
</tr>
<tr>
<td>HVSS (Pin 15)</td>
<td>0V</td>
<td>0V</td>
<td>✅ 정상</td>
</tr>
<tr>
<td>REF (Pin 24)</td>
<td>2.5V</td>
<td>0V</td>
<td>❌ 비정상</td>
</tr>
<tr>
<td>REFGND (Pin 23)</td>
<td>0V</td>
<td>0V</td>
<td>✅ 정상</td>
</tr>
<tr>
<td>REF-REFGND 커패시터</td>
<td>4.7µF or 10µF</td>
<td>실장됨</td>
<td>✅ 정상</td>
</tr>
</tbody>
</table>
                </div>
                
                <div class="slide-content">
                    <h2>3. 디버깅 과정</h2>
<h3>3.1 소프트웨어 검증</h3>
<h4>SPI 설정 확인</h4>
<div class="highlight"><pre><span></span><code><span class="c1">// main.c - SPI4 설정</span>
<span class="n">hspi4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">Mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_MODE_MASTER</span><span class="p">;</span>
<span class="n">hspi4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">CLKPolarity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_POLARITY_LOW</span><span class="p">;</span><span class="w">      </span><span class="c1">// CPOL=0</span>
<span class="n">hspi4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">CLKPhase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_PHASE_2EDGE</span><span class="p">;</span><span class="w">          </span><span class="c1">// CPHA=1 (SPI Mode 1)</span>
<span class="n">hspi4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">BaudRatePrescaler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_BAUDRATEPRESCALER_32</span><span class="p">;</span><span class="w">  </span><span class="c1">// 3.75MHz</span>
<span class="n">hspi4</span><span class="p">.</span><span class="n">Init</span><span class="p">.</span><span class="n">NSSPMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SPI_NSS_PULSE_DISABLE</span><span class="p">;</span><span class="w">    </span><span class="c1">// CS 펄스 비활성화</span>
</code></pre></div>

<p><strong>결과</strong>: 데이터시트 요구사항과 일치 ✅</p>
<h4>핀 연결 확인</h4>
<div class="highlight"><pre><span></span><code>STM32H743           ADS8638
PE2  (SPI4_SCK)  →  Pin 17 (SCLK)    ✅
PE6  (SPI4_MOSI) →  Pin 18 (DIN/SDI) ✅
PE13 (SPI4_MISO) →  Pin 19 (DOUT)    ✅
PD1  (GPIO)      →  Pin 16 (CS)      ✅
</code></pre></div>

<p><strong>멀티미터 연속성 테스트</strong>: 모두 정상 연결 확인 ✅</p>
<h3>3.2 오실로스코프 분석</h3>
<h4>측정 조건</h4>
<ul>
<li>CH1: CS (PD1)</li>
<li>CH2: SCK (PE2)</li>
<li>CH3: MOSI (PE6)</li>
<li>CH4: MISO (PE13)</li>
<li>Trigger: CS falling edge</li>
<li>Timebase: 2.00µs/div</li>
</ul>
<h4>측정 결과 (WRITE 명령: 0x0C0C)</h4>
<div class="highlight"><pre><span></span><code>CS (파란색):   ‾‾‾‾\___________________/‾‾‾‾  ✅ 16 클럭 동안 LOW 유지
SCK (노란색):       ||||||||||||||||||||||||  ✅ 16 클럭 정상
MISO (청록색): ‾‾‾‾‾\_____응답_____/‾‾‾‾‾‾  ✅ 응답 있음
MOSI (분홍색): ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾  ⚠️ 거의 변화 없음
</code></pre></div>

<p><strong>분석</strong>:<br>
- CS 타이밍: 정상 (NSSPMode=DISABLE 효과 확인)<br>
- MOSI: 데이터 전송은 되지만 파형 해상도 부족으로 비트 패턴 미확인<br>
- MISO: 칩이 응답은 하지만 레지스터 값은 0x00</p>
<h3>3.3 READ vs WRITE 비교</h3>
<table>
<thead>
<tr>
<th>동작</th>
<th>TX 명령</th>
<th>RX 응답</th>
<th>결과</th>
</tr>
</thead>
<tbody>
<tr>
<td>READ Aux-Config (0x06)</td>
<td>0x0D00</td>
<td>0x0F00</td>
<td>하위 8비트 = 0x00 ✅ READ 동작</td>
</tr>
<tr>
<td>WRITE 0x0C to Aux-Config</td>
<td>0x0C0C</td>
<td>0x0F??</td>
<td>WRITE 후 읽으면 여전히 0x00 ❌</td>
</tr>
<tr>
<td>READ CH0-1 Range (0x10)</td>
<td>0x2100</td>
<td>0x0F00</td>
<td>하위 8비트 = 0x00 ✅ READ 동작</td>
</tr>
</tbody>
</table>
<p><strong>결론</strong>: READ는 동작하지만 WRITE는 완전히 실패</p>
<h3>3.4 테스트한 칩 이력</h3>
<table>
<thead>
<tr>
<th>칩 번호</th>
<th>납땜 조건</th>
<th>HVDD</th>
<th>WRITE 결과</th>
<th>REF 전압</th>
<th>비고</th>
</tr>
</thead>
<tbody>
<tr>
<td>칩 #1</td>
<td>300°C</td>
<td>4.8V → 12V</td>
<td>실패 (0x00)</td>
<td>0V</td>
<td>첫 번째 테스트</td>
</tr>
<tr>
<td>칩 #2</td>
<td>300°C</td>
<td>12V</td>
<td>실패 (0x00)</td>
<td>0V</td>
<td>교체 후 동일 증상</td>
</tr>
<tr>
<td>칩 #3</td>
<td>300°C</td>
<td>12V</td>
<td>실패 (0x00)</td>
<td>0V</td>
<td>세 번째도 동일</td>
</tr>
</tbody>
</table>
<p><strong>3개 칩 모두 동일한 증상</strong> → 납땜 온도 문제로 추정</p>
                </div>
                
                <div class="slide-content">
                    <h2>4. 근본 원인 분석</h2>
<h3>4.1 납땜 온도 문제</h3>
<h4>사용된 온도</h4>
<div class="highlight"><pre><span></span><code>HOT PLATE 온도: 300°C
접촉 시간: 20초 이상
</code></pre></div>

<h4>데이터시트 권장 스펙</h4>
<div class="highlight"><pre><span></span><code>Storage temperature: -65°C to +150°C (동작 안 할 때)
Operating temperature: -40°C to +125°C (동작 중)

일반적인 무연 납땜 권장 온도:
- 핸드 납땜: 260-280°C (최대 280°C)
- 리플로우: 피크 245-260°C (10-30초)
- 절대 최대: 270°C
</code></pre></div>

<p><strong>300°C는 권장 온도 대비 20-40°C 초과</strong> → 칩 내부 회로 손상 가능</p>
<h3>4.2 손상 패턴 분석</h3>
<h4>정상 동작 부분</h4>
<ul>
<li>✅ 디지털 I/O (SPI 통신, CS, SCK, MISO)</li>
<li>✅ READ 명령 처리 로직</li>
<li>✅ 전원 회로 (AVDD, DVDD, HVDD)</li>
</ul>
<h4>손상된 부분</h4>
<ul>
<li>❌ 레지스터 쓰기 회로</li>
<li>❌ 내부 2.5V 레퍼런스 회로</li>
<li>❌ ADC 변환 회로 (또는 레퍼런스 부족으로 동작 불가)</li>
</ul>
<p><strong>추정</strong>: 고온에 취약한 아날로그 회로 부분이 선택적으로 손상</p>
<h3>4.3 HVDD 전원 문제 (초기 보드)</h3>
<p>일부 초기 보드에서 발생한 문제:</p>
<div class="highlight"><pre><span></span><code>HVDD/HVSS: 연결 안 됨
임시 조치: 수작업으로 3.3V 연결
결과: 채널 변경 문제 발생
</code></pre></div>

<p><strong>데이터시트 요구사항</strong>:</p>
<div class="highlight"><pre><span></span><code>HVDD - HVSS 차동 전압: 10V &lt; (HVDD - HVSS) &lt; 30V
3.3V는 최소 요구사항 10V에 크게 미달
</code></pre></div>

<p><strong>영향</strong>: 입력 범위 제한, 아날로그 스위치 오동작 가능</p>
                </div>
                
                <div class="slide-content">
                    <h2>5. 테스트 코드 및 결과</h2>
<h3>5.1 진단 테스트 시퀀스</h3>
<div class="highlight"><pre><span></span><code>Step 0: Raw SPI Test
  TX=[0x00 0x00] → RX=[0x0F 0xFF]
  TX=[0xAA 0x55] → RX=[0x0F 0x00]
  → MISO 응답 있음, 고정 패턴 아님 ✅

Step 1: Power-on Defaults (초기화 전 READ)
  Aux-Config (0x06): 0x00 (Expected: 0x08)
  CH0-1 Range (0x10): 0x00 (Expected: 0x11)
  → 칩 리셋이 안 되거나 이전 값 유지

Step 1A: WRITE Test
  Write 0x0C → Read 0x00
  *** WRITE FAILED! ***
  → 레지스터 쓰기 완전 실패 ❌

Step 2: Initialization
  ADS8638_Init() 실행
  → 모든 WRITE 명령 무시됨

Step 4: Register Verification
  Aux-Config: 0x00 (Expected: 0x0C) ❌
  Auto Ch-Sel: 0x00 (Expected: 0xFF) ❌
  CH0-1 Range: 0x00 (Expected: 0x66) ❌

Step 5-6: ADC Readings
  CH0-7: 모두 4095 (0xFFF) ❌
  → 레퍼런스 부족으로 측정 불가
</code></pre></div>

<h3>5.2 드라이버 코드 (ads8638.c)</h3>
<p>초기화 시퀀스:</p>
<div class="highlight"><pre><span></span><code><span class="n">HAL_StatusTypeDef</span><span class="w"> </span><span class="nf">ADS8638_Init</span><span class="p">(</span><span class="n">ADS8638_HandleTypeDef</span><span class="w"> </span><span class="o">*</span><span class="n">hadc</span><span class="p">,</span><span class="w"> </span><span class="n">SPI_HandleTypeDef</span><span class="w"> </span><span class="o">*</span><span class="n">hspi</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Step 1: CS HIGH during power-up</span>
<span class="w">    </span><span class="n">ADS8638_CS_HIGH</span><span class="p">();</span>
<span class="w">    </span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Step 2: Dummy transaction</span>
<span class="w">    </span><span class="n">ADS8638_SendCommand</span><span class="p">(</span><span class="n">hadc</span><span class="p">,</span><span class="w"> </span><span class="n">ADS8638_CMD_NO_OP</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">response</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Step 3: Software reset</span>
<span class="w">    </span><span class="n">ADS8638_WriteRegister</span><span class="p">(</span><span class="n">hadc</span><span class="p">,</span><span class="w"> </span><span class="n">ADS8638_REG_RESET_DEVICE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x01</span><span class="p">);</span>
<span class="w">    </span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Step 4: Enable internal VREF (bit 2 = 1)</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">aux_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">;</span><span class="w">  </span><span class="c1">// AL_PD(0x08) | INT_VREF(0x04)</span>
<span class="w">    </span><span class="n">ADS8638_WriteRegister</span><span class="p">(</span><span class="n">hadc</span><span class="p">,</span><span class="w"> </span><span class="n">ADS8638_REG_AUX_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">aux_config</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Step 5: Wait for VREF settling (9ms spec)</span>
<span class="w">    </span><span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Step 6-8: Configure channels and ranges</span>
<span class="w">    </span><span class="n">ADS8638_WriteRegister</span><span class="p">(</span><span class="n">hadc</span><span class="p">,</span><span class="w"> </span><span class="n">ADS8638_REG_AUTO_CH_SEL</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// ... (생략)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">HAL_OK</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>문제</strong>: 모든 WriteRegister 호출이 무시됨</p>
                </div>
                
                <div class="slide-content">
                    <h2>6. 결론</h2>
<h3>6.1 판정</h3>
<p><strong>ADS8638 칩 불량 - 부분 손상 상태</strong></p>
<ul>
<li>디지털 I/O 회로: 정상</li>
<li>레지스터 쓰기 회로: 손상</li>
<li>내부 레퍼런스: 손상</li>
<li>ADC 코어: 레퍼런스 부족으로 동작 불가 (코어 자체 손상 가능성도 있음)</li>
</ul>
<h3>6.2 원인</h3>
<p><strong>주요 원인</strong>: 과도한 납땜 온도 (300°C)<br>
- 권장 온도: 260-280°C<br>
- 초과량: 20-40°C<br>
- 영향: 아날로그 회로 열 손상</p>
<p><strong>부가적 요인</strong>:<br>
- 일부 칩은 공급 단계부터 고온 납땜되어 손상되었을 가능성<br>
- 초기 보드의 HVDD/HVSS 미연결로 인한 추가 스트레스</p>
<h3>6.3 재현성</h3>
<p>총 3개 칩 테스트:<br>
- 칩 #1, #2, #3: 모두 동일 증상<br>
- 재현율: 100%<br>
- 소프트웨어 문제 가능성: 배제 (오실로스코프로 하드웨어 검증)</p>
                </div>
                
                <div class="slide-content">
                    <h2>7. 권장 조치사항</h2>
<h3>7.1 즉시 조치 (긴급)</h3>
<h4>납땜 온도 관리</h4>
<div class="highlight"><pre><span></span><code>핸드 납땜:
- 인두 온도: 260-280°C (최대 280°C, 절대 300°C 이상 금지)
- 접촉 시간: 2-3초 이내
- 무연 납 (Sn-Ag-Cu) 사용
- 써멀 트위저 사용 시 온도 재확인

리플로우 오븐 (권장):
- 예열: 150-180°C (60-90초)
- 솔더: 200-220°C (30-60초)
- 피크: 245-255°C (10-20초 유지)
- 냉각: 자연 냉각
</code></pre></div>

<h4>칩 교체</h4>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">새</span><span class="w"> </span><span class="n">칩</span><span class="w"> </span><span class="n">발주</span><span class="w"> </span><span class="p">(</span><span class="n">여분</span><span class="w"> </span><span class="n">포함</span><span class="p">)</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">올바른</span><span class="w"> </span><span class="n">온도</span><span class="p">(</span><span class="mf">260</span><span class="o">-</span><span class="mf">280</span><span class="err">°</span><span class="n">C</span><span class="p">)</span><span class="n">로</span><span class="w"> </span><span class="n">재납땜</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">납땜</span><span class="w"> </span><span class="n">후</span><span class="w"> </span><span class="n">즉시</span><span class="w"> </span><span class="n">테스트</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">전원</span><span class="w"> </span><span class="n">전압</span><span class="w"> </span><span class="n">확인</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">REF</span><span class="w"> </span><span class="n">핀</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.5</span><span class="n">V</span><span class="w"> </span><span class="n">확인</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">WRITE</span><span class="w"> </span><span class="n">테스트</span><span class="w"> </span><span class="n">통과</span><span class="w"> </span><span class="n">확인</span>
</code></pre></div>

<h3>7.2 품질 검증 절차 수립</h3>
<h4>입고 검사</h4>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">육안</span><span class="w"> </span><span class="n">검사</span><span class="p">:</span><span class="w"> </span><span class="n">변색</span><span class="p">,</span><span class="w"> </span><span class="n">크랙</span><span class="w"> </span><span class="n">확인</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">전기적</span><span class="w"> </span><span class="n">테스트</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">전원</span><span class="w"> </span><span class="n">인가</span><span class="w"> </span><span class="n">전</span><span class="w"> </span><span class="n">단락</span><span class="w"> </span><span class="n">테스트</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">전원</span><span class="w"> </span><span class="n">인가</span><span class="w"> </span><span class="n">후</span><span class="w"> </span><span class="n">전압</span><span class="w"> </span><span class="n">측정</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">REF</span><span class="w"> </span><span class="n">핀</span><span class="w"> </span><span class="mf">2.5</span><span class="n">V</span><span class="w"> </span><span class="n">확인</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">간단한</span><span class="w"> </span><span class="n">WRITE</span><span class="o">/</span><span class="kr">READ</span><span class="w"> </span><span class="n">테스트</span>
</code></pre></div>

<h4>납땜 후 검사</h4>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">브리지</span><span class="w"> </span><span class="n">확인</span><span class="w"> </span><span class="p">(</span><span class="n">현미경</span><span class="p">)</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">전원</span><span class="w"> </span><span class="n">전압</span><span class="w"> </span><span class="n">확인</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">REF</span><span class="w"> </span><span class="n">핀</span><span class="w"> </span><span class="n">전압</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.5</span><span class="n">V</span><span class="w"> </span><span class="n">확인</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">test_ads8638</span><span class="p">()</span><span class="w"> </span><span class="n">실행</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="kr">Step</span><span class="w"> </span><span class="mf">1</span><span class="n">A</span><span class="p">:</span><span class="w"> </span><span class="n">WRITE</span><span class="w"> </span><span class="n">SUCCESS</span><span class="w"> </span><span class="n">확인</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="kr">Step</span><span class="w"> </span><span class="mf">4</span><span class="p">:</span><span class="w"> </span><span class="n">레지스터</span><span class="w"> </span><span class="n">값</span><span class="w"> </span><span class="n">일치</span><span class="w"> </span><span class="n">확인</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="kr">Step</span><span class="w"> </span><span class="mf">5</span><span class="o">-</span><span class="mf">6</span><span class="p">:</span><span class="w"> </span><span class="n">ADC</span><span class="w"> </span><span class="n">값</span><span class="w"> </span><span class="n">정상</span><span class="w"> </span><span class="n">확인</span><span class="w"> </span><span class="p">(</span><span class="mf">4095</span><span class="w"> </span><span class="n">아님</span><span class="p">)</span>
</code></pre></div>

<h3>7.3 설계 개선 (장기)</h3>
<h4>HVDD/HVSS 연결 확인</h4>
<div class="highlight"><pre><span></span><code>- HVDD: 12V 이상 연결 (10V 최소)
- HVSS: 0V (GND) 또는 음전압
- 차동 전압: 10V &lt; (HVDD - HVSS) &lt; 30V 준수
</code></pre></div>

<h4>외부 레퍼런스 옵션 추가 (선택)</h4>
<div class="highlight"><pre><span></span><code>내부 레퍼런스 손상 시 우회 가능:
- REF 핀에 외부 2.5V 공급
- Aux-Config에서 내부 VREF 비활성화 (bit 2 = 0)
</code></pre></div>
                </div>
                
                <div class="slide-content">
                    <h2>8. 기술 세부사항 (참고)</h2>
<h3>8.1 ADS8638 레지스터 맵</h3>
<table>
<thead>
<tr>
<th>Address</th>
<th>Name</th>
<th>Function</th>
<th>Default</th>
<th>Test Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>RESET_DEVICE</td>
<td>Software reset</td>
<td>0x00</td>
<td>N/A</td>
</tr>
<tr>
<td>0x06</td>
<td>AUX_CONFIG</td>
<td>VREF, Temp sensor</td>
<td>0x08</td>
<td>0x00 ❌</td>
</tr>
<tr>
<td>0x0C</td>
<td>AUTO_CH_SEL</td>
<td>Channel enable</td>
<td>0x00</td>
<td>0x00 ❌</td>
</tr>
<tr>
<td>0x10</td>
<td>CH0_1_RANGE</td>
<td>Ch0-1 range</td>
<td>0x11</td>
<td>0x00 ❌</td>
</tr>
</tbody>
</table>
<h3>8.2 SPI 통신 프로토콜</h3>
<h4>16비트 프레임 구조</h4>
<div class="highlight"><pre><span></span><code>Bits[15:9]: Register Address (7 bits)
Bit[8]:     R/W (1=READ, 0=WRITE)
Bits[7:0]:  Data (WRITE) or Don't Care (READ)

예: Aux-Config(0x06) WRITE 0x0C
TX: 0x0C0C = [0000110][0][00001100]
              Addr=6  W  Data=0x0C

예: Aux-Config(0x06) READ
TX: 0x0D00 = [0000110][1][00000000]
              Addr=6  R  Don't care
RX: 0x0F00 = [????][Data=0x00]
             (상위 8비트 무시, 하위 8비트가 레지스터 값)
</code></pre></div>

<h3>8.3 전원 사양</h3>
<table>
<thead>
<tr>
<th>핀</th>
<th>이름</th>
<th>전압</th>
<th>용도</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>AVDD</td>
<td>3.3V</td>
<td>아날로그 전원</td>
</tr>
<tr>
<td>2,3</td>
<td>AGND</td>
<td>0V</td>
<td>아날로그 GND</td>
</tr>
<tr>
<td>14</td>
<td>HVDD</td>
<td>12V</td>
<td>고전압 입력 전원</td>
</tr>
<tr>
<td>15</td>
<td>HVSS</td>
<td>0V</td>
<td>고전압 GND</td>
</tr>
<tr>
<td>20</td>
<td>DGND</td>
<td>0V</td>
<td>디지털 GND</td>
</tr>
<tr>
<td>21</td>
<td>DVDD</td>
<td>3.3V</td>
<td>디지털 I/O 전원</td>
</tr>
<tr>
<td>23</td>
<td>REFGND</td>
<td>0V (AGND 연결)</td>
<td>레퍼런스 GND</td>
</tr>
<tr>
<td>24</td>
<td>REF</td>
<td>2.5V (내부 생성)</td>
<td>레퍼런스 전압</td>
</tr>
</tbody>
</table>
<h3>8.4 입력 범위 설정</h3>
<div class="highlight"><pre><span></span><code><span class="cp">#define ADS8638_RANGE_UNIPOLAR_5V    0x06  </span><span class="c1">// 0 to 5V (HVDD ≥ 10V)</span>
<span class="cp">#define ADS8638_RANGE_UNIPOLAR_10V   0x05  </span><span class="c1">// 0 to 10V (HVDD ≥ 15V)</span>

<span class="c1">// HVDD = 12V일 때 0-5V 범위 사용 권장</span>
</code></pre></div>
                </div>
                
                <div class="slide-content">
                    <h2>9. 첨부 자료</h2>
<h3>9.1 파일 목록</h3>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">소스</span><span class="w"> </span><span class="n">코드</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">bldc_h743_v101</span><span class="mf">.</span><span class="n">zip</span><span class="w">          </span><span class="p">(</span><span class="n">ADS8638</span><span class="w"> </span><span class="n">드라이버</span><span class="w"> </span><span class="n">구현</span><span class="w"> </span><span class="n">소스</span><span class="w"> </span><span class="n">코드</span><span class="w"> </span><span class="n">전체</span><span class="p">)</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">오실로스코프</span><span class="w"> </span><span class="n">캡처</span><span class="p">:</span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="mf">.</span><span class="n">doc</span><span class="o">/</span><span class="mf">2.</span><span class="n">png</span><span class="w">                  </span><span class="p">(</span><span class="n">CS</span><span class="o">/</span><span class="n">SCK</span><span class="o">/</span><span class="n">MOSI</span><span class="o">/</span><span class="n">MISO</span><span class="w"> </span><span class="n">파형</span><span class="p">)</span>


<span class="err">###</span><span class="w"> </span><span class="mf">9.2</span><span class="w"> </span><span class="n">테스트</span><span class="w"> </span><span class="n">명령</span>

<span class="err">```</span><span class="n">c</span>
<span class="o">//</span><span class="w"> </span><span class="n">main</span><span class="mf">.</span><span class="n">c에서</span><span class="w"> </span><span class="n">호출</span>
<span class="n">void</span><span class="w"> </span><span class="kr">run</span><span class="n">_proc</span><span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">test_ads8638</span><span class="p">();</span>
<span class="err">}</span>
</code></pre></div>
                </div>
                
                <div class="slide-content">
                    <h2>10. 연락처</h2>
<p>문의사항이나 추가 테스트가 필요한 경우 연락 바랍니다.</p>
<p><strong>프로젝트</strong>: STM32H743 BLDC 모터 제어 보드<br>
<strong>칩</strong>: ADS8638 (TI)<br>
<strong>인터페이스</strong>: SPI4 (STM32H743)<br>
<strong>테스트 환경</strong>: STM32CubeIDE 1.19.0, ARM GCC 13.3</p>
                </div>
                
            
            
            </body></html>